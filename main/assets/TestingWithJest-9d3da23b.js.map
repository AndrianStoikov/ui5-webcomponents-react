{"version":3,"file":"TestingWithJest-9d3da23b.js","sources":["../../docs/knowledge-base/TestingWithJest.mdx"],"sourcesContent":["import { Meta } from '@storybook/addon-docs';\nimport { MessageStrip, MessageStripDesign } from '@ui5/webcomponents-react';\nimport { Footer, TableOfContent } from '@sb/components';\n\n<Meta title=\"Testing with Jest\" />\n\n# Testing with Jest\n\n<MessageStrip\n  design={MessageStripDesign.Warning}\n  hideCloseButton\n  children={\n    <>\n      <b>We don't recommend testing UI5 Web Components for React with Jest anymore!</b>\n      <br />\n      Please use{' '}\n      <ui5-link href=\"https://sap.github.io/ui5-webcomponents-react/?path=/docs/testing-with-cypress-setup--docs\">\n        Cypress\n      </ui5-link>{' '}\n      instead.\n    </>\n  }\n/>\n\nDue to the lack of custom elements support when using the JSDOM, resulting in cumbersome mocking and behavior that is not applicable when actually interacting with the components, we dropped the support for testing with Jest and moved on to [Cypress](https://sap.github.io/ui5-webcomponents-react/?path=/docs/testing-with-cypress-setup--docs). This guide will still work, but we may remove the Jest setup file with our next major release.\n\n---\n\nThis guide is applicable if you are using a standard `create-react-app` setup.\n\n<TableOfContent />\n\n## Transpile Modules\n\n`create-react-app` offers you to modify specific parts of the `jest` config by adding `jest` object to your `package.json`.\nHere you need to tell `jest` to transpile the UI5 Web Components as well as the `lit-html` library:<br />\n`package.json:`\n\n```json\n{\n  \"jest\": {\n    \"transformIgnorePatterns\": [\"node_modules/(?!(@ui5|lit-html)).*\\\\.js$\"]\n  }\n}\n```\n\nIn case you are using our chart library `@ui5/webcomponents-react-charts` as well, you'll have to add `d3` and `internmap` to the configuration:\n\n```json\n{\n  \"jest\": {\n    \"transformIgnorePatterns\": [\"node_modules/(?!(@ui5|lit-html|d3|internmap)).*\\\\.js$\"]\n  }\n}\n```\n\n## Mocking\n\n### Resize Observer\n\nSince some components of UI5 Web Components and UI5 Web Components for React are based on the `ResizeObserver` API, you'll need to add a polyfill for it.\nOur recommendation is the `resize-observer-polyfill` package, you can install it by running `npm install resize-observer-polyfill --save-dev`.\n\n### React.useId\n\nIf you want to test your app by creating snapshots, you may need to mock the `useId` hook offered by React since version 18.\nThis hook returns a unique id across all components, but as your snapshot should be stable you can't have it there.\n\n```js\njest.mock('react', () => {\n  return { ...jest.requireActual('react'), useId: () => ':mocked' };\n});\n```\n\n<MessageStrip\n  hideCloseButton\n  children={\n    <>\n      Snapshot testing is a{' '}\n      <ui5-link href={'https://kentcdodds.com/blog/effective-snapshot-testing'}>\n        controversial and complex topic\n      </ui5-link>\n      , but especially with web components it gets really tricky as the JSDOM doesn't support rendering the shadow-root out\n      of the box. That's why we recommend to go without extensively using snapshots.\n    </>\n  }\n/>\n\n## Jest Setup File\n\nAll other prerequisites of the UI5 Web Components for React Library can be fulfilled by importing our jest setup file:\n`import '@ui5/webcomponents-react/jestSetup.js';`\n\nTherefore, create (or edit) your `src/setupTests.js` file as follows:\n\n```js\nimport ResizeObserverPolyfill from 'resize-observer-polyfill';\nimport '@ui5/webcomponents-react/jestSetup.js';\n\nwindow.ResizeObserver = ResizeObserverPolyfill;\n\njest.mock('react', () => {\n  return { ...jest.requireActual('react'), useId: () => ':mocked' };\n});\n```\n\n<MessageStrip\n  hideCloseButton\n  children={\n    <>\n      Please note that you must also wrap your components in the `ThemeProvider` component for testing, otherwise\n      components with translations will probably not render.\n    </>\n  }\n/>\n\nNow you should be able to run your test by using `npm run test` or `yarn test`.\n\n<div style={{ height: 'var(--_ui5_bar_base_height)' }} />\n<Footer style={{ position: 'fixed', bottom: 0, zIndex: 2, maxHeight: 'var(--_ui5_bar_base_height)' }} />\n"],"names":["MDXContent","props","MDXLayout","_provideComponents","_jsx","_createMdxContent","_components","_jsxs","_Fragment","Meta","MessageStrip","MessageStripDesign","TableOfContent","Footer"],"mappings":"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"}