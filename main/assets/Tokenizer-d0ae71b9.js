import{r as g,U as A,d as L}from"./UI5Element-5c53814f.js";import{e as l,l as n,s as a,d as z,a as O,b as H}from"./withWebComponent-b8903b2e.js";import{R as k}from"./ResizeHandler-da7c4a52.js";import{I as B}from"./ItemNavigation-1cd3f78d.js";import{S as V}from"./ScrollEnablement-73e19dd8.js";import{I as v}from"./Integer-44c9be94.js";import{B as K,c as W,I as q,J as U,K as j,x as Z,y as T,v as S,w as F,q as J,r as w,o as X,p as b,L as Y,M as y,h as G,j as $,D as Q,E as C,m as ee,n as E,k as te,l as I}from"./Keys-50a1cb5a.js";import{o as f,c as _}from"./class-map-a4eccd4f.js";import{V as d}from"./ValueState-2c5e5904.js";import oe from"./ResponsivePopover-9c15f502.js";import{L as ie}from"./ListItemBase-4b52d1f0.js";import{a as se}from"./Title-fb9c1aba.js";import{c as m,B as re}from"./Button-6ca701be.js";import ne from"./StandardListItem-ddbc126c.js";import{s as h}from"./style-map-f4770aeb.js";import{X as ae,Y as le,Z as de,_ as pe,$ as he,a0 as ce}from"./MarkedEvents-f33713fa.js";import{R as ue}from"./ResponsivePopoverCommon.css-1186d6a9.js";import{v as me}from"./ValueStateMessage.css-57760618.js";import{S as fe}from"./Suggestions.css-af656ac7.js";const ge=(i,e,t)=>l`<div class="${f(i.classes.wrapper)}"><span id="${n(i._id)}-hiddenText" class="ui5-hidden-text">${n(i.tokenizerLabel)}</span><div class="${f(i.classes.content)}" @ui5-delete="${n(i._delete)}" @click="${i._click}" @mousedown="${i._onmousedown}" @keydown="${i._onkeydown}" role="listbox" aria-labelledby="${n(i._id)}-hiddenText">${m(i.tokens,(o,s)=>o._id||s,(o,s)=>_e(o))}</div>${i.showNMore?ke(i):void 0}</div>`,_e=(i,e,t,o,s)=>l`<slot name="${n(i._individualSlot)}"></slot>`,ke=(i,e,t)=>l`<span @click="${i._openOverflowPopover}" class="ui5-tokenizer-more-text" part="n-more-text">${n(i._nMoreText)}</span>`,ve=(i,e,t)=>t?l`<${a("ui5-responsive-popover",e,t)} tokenizer-popover="true" style=${h(i.styles.popover)} ?content-only-on-desktop="${i.hasValueState}" hide-arrow placement-type="Bottom" horizontal-align="Left"><div slot="header" class="ui5-responsive-popover-header" style="${h(i.styles.popoverHeader)}">${i._isPhone?D(i,e,t):void 0}${i.hasValueState?void 0:x(i,e,t)}</div><${a("ui5-list",e,t)} class="ui5-tokenizer-list" mode="Delete" @ui5-item-delete=${n(i.itemDelete)}>${m(i._tokens,(o,s)=>o._id||s,(o,s)=>M(o,s,i,e,t))}</${a("ui5-list",e,t)}>${i._isPhone?R(i,e,t):void 0}</${a("ui5-responsive-popover",e,t)}>`:l`<ui5-responsive-popover tokenizer-popover="true" style=${h(i.styles.popover)} ?content-only-on-desktop="${i.hasValueState}" hide-arrow placement-type="Bottom" horizontal-align="Left"><div slot="header" class="ui5-responsive-popover-header" style="${h(i.styles.popoverHeader)}">${i._isPhone?D(i,e,t):void 0}${i.hasValueState?void 0:x(i,e,t)}</div><ui5-list class="ui5-tokenizer-list" mode="Delete" @ui5-item-delete=${n(i.itemDelete)}>${m(i._tokens,(o,s)=>o._id||s,(o,s)=>M(o,s,i,e,t))}</ui5-list>${i._isPhone?R(i,e,t):void 0}</ui5-responsive-popover>`,D=(i,e,t)=>t?l`<div class="row" style="${h(i.styles.popoverHeaderTitle)}"><${a("ui5-title",e,t)} level="H5" class="ui5-responsive-popover-header-text">${n(i.morePopoverTitle)}</${a("ui5-title",e,t)}><${a("ui5-button",e,t)} class="ui5-responsive-popover-close-btn" icon="decline" design="Transparent" @click="${i.closeMorePopover}"></${a("ui5-button",e,t)}></div>`:l`<div class="row" style="${h(i.styles.popoverHeaderTitle)}"><ui5-title level="H5" class="ui5-responsive-popover-header-text">${n(i.morePopoverTitle)}</ui5-title><ui5-button class="ui5-responsive-popover-close-btn" icon="decline" design="Transparent" @click="${i.closeMorePopover}"></ui5-button></div>`,x=(i,e,t)=>t?l`<div class="${f(i.classes.popoverValueState)}" style="${h(i.styles.popoverValueStateMessage)}"><${a("ui5-icon",e,t)} class="ui5-input-value-state-message-icon" name="${n(i._valueStateMessageIcon)}"></${a("ui5-icon",e,t)}>${m(i.valueStateMessageText,(o,s)=>o._id||s,(o,s)=>N(o))}</div>`:l`<div class="${f(i.classes.popoverValueState)}" style="${h(i.styles.popoverValueStateMessage)}"><ui5-icon class="ui5-input-value-state-message-icon" name="${n(i._valueStateMessageIcon)}"></ui5-icon>${m(i.valueStateMessageText,(o,s)=>o._id||s,(o,s)=>N(o))}</div>`,N=(i,e,t,o,s)=>l`${n(i)}`,M=(i,e,t,o,s)=>s?l`<${a("ui5-li",o,s)} .tokenRef=${n(i)}>${n(i.text)}</${a("ui5-li",o,s)}>`:l`<ui5-li .tokenRef=${n(i)}>${n(i.text)}</ui5-li>`,R=(i,e,t)=>t?l`<div slot="footer" class="ui5-responsive-popover-footer"><${a("ui5-button",e,t)} design="Transparent" @click="${i.closeMorePopover}">OK</${a("ui5-button",e,t)}></div>`:l`<div slot="footer" class="ui5-responsive-popover-footer"><ui5-button design="Transparent" @click="${i.closeMorePopover}">OK</ui5-button></div>`;g("@ui5/webcomponents-theming","sap_fiori_3",()=>z);g("@ui5/webcomponents","sap_fiori_3",()=>O);const Te={packageName:"@ui5/webcomponents",fileName:"themes/Tokenizer.css",content:':host{display:inline-block;box-sizing:border-box;border:1px solid #000;height:2.25rem}.ui5-hidden-text{width:1px;overflow:hidden;color:transparent}.ui5-tokenizer-root{height:100%;display:flex;align-items:center;overflow-x:scroll;box-sizing:border-box;font-family:"72override",var(--sapFontFamily)}.ui5-tokenizer-no-padding{padding:0}.ui5-tokenizer-root.ui5-tokenizer-nmore--wrapper{overflow:hidden}.ui5-tokenizer--token--wrapper{display:inline-flex;align-items:center;box-sizing:border-box;height:100%}:host([expanded]) .ui5-tokenizer--content{display:inline-block;white-space:nowrap}.ui5-tokenizer--content{display:flex;flex-wrap:nowrap;align-items:center;overflow:hidden;padding-inline-start:var(--_ui5_tokenizer_padding)}.ui5-tokenizer-more-text{display:inline-block;margin-inline-start:.25rem;cursor:pointer;white-space:nowrap;font-size:var(--sapFontSize);font-weight:400;color:var(--_ui5_tokenizer_n_more_text_color)}:host([expanded]) .ui5-tokenizer--content{overflow:hidden;justify-content:flex-end}'};g("@ui5/webcomponents-theming","sap_fiori_3",()=>z);g("@ui5/webcomponents","sap_fiori_3",()=>O);const Se={packageName:"@ui5/webcomponents",fileName:"themes/TokenizerPopover.css",content:"[ui5-responsive-popover]::part(content),[ui5-responsive-popover]::part(header){padding:0}"},we={tag:"ui5-tokenizer",languageAware:!0,managedSlots:!0,slots:{default:{propertyName:"tokens",type:HTMLElement,individualSlots:!0},valueStateMessage:{propertyName:"valueStateMessage",type:HTMLElement}},properties:{showMore:{type:Boolean},disabled:{type:Boolean},expanded:{type:Boolean},morePopoverOpener:{type:Object},popoverMinWidth:{type:v},valueState:{type:d,defaultValue:d.None},_nMoreCount:{type:v}},events:{"token-delete":{detail:{ref:{type:HTMLElement}}},"show-more-items-press":{detail:{ref:{type:HTMLElement}}}}};class p extends A{static get metadata(){return we}static get render(){return H}static get template(){return ge}static get styles(){return Te}static get staticAreaStyles(){return[ue,me,fe,Se]}static get staticAreaTemplate(){return ve}_handleResize(){this._nMoreCount=this.overflownTokens.length}constructor(){super(),this._resizeHandler=this._handleResize.bind(this),this._itemNav=new B(this,{currentIndex:"-1",getItemsCallback:this._getVisibleTokens.bind(this)}),this._scrollEnablement=new V(this)}async onBeforeRendering(){this.showPopover&&!this._getTokens().length&&(await this.getPopover()).close(),this._nMoreCount=this.overflownTokens.length}onEnterDOM(){k.register(this.shadowRoot.querySelector(".ui5-tokenizer--content"),this._resizeHandler)}onExitDOM(){k.deregister(this.shadowRoot.querySelector(".ui5-tokenizer--content"),this._resizeHandler)}async _openOverflowPopover(){this.showPopover&&(await this.getPopover()).showAt(this.morePopoverOpener||this),this.fireEvent("show-more-items-press")}_getTokens(){return this.getSlottedNodes("tokens")}get _tokens(){return this.getSlottedNodes("tokens")}get showPopover(){return Object.keys(this.morePopoverOpener).length}_getVisibleTokens(){return this.disabled?[]:this._tokens.filter((e,t)=>t<this._tokens.length-this._nMoreCount)}onAfterRendering(){this._scrollEnablement.scrollContainer=this.expanded||!this.narrowContentDom?this.expandedContentDom:this.narrowContentDom,this.expanded&&(this._expandedScrollWidth=this.expandedContentDom.scrollWidth,this.scrollToEnd()),this.expanded||this.scrollToStart()}_delete(e){if(!e.detail){this._tokenClickDelete(e,e.target);return}this._selectedTokens.length?this._selectedTokens.forEach(t=>this._tokenKeyboardDelete(e,t)):this._tokenKeyboardDelete(e)}_tokenClickDelete(e,t){const o=this._getVisibleTokens(),s=t?o.indexOf(t):o.indexOf(e.target),r=s===o.length-1?s-1:s+1,u=o[r];this._handleCurrentItemAfterDeletion(u),this.fireEvent("token-delete",{ref:t||e.target})}_handleCurrentItemAfterDeletion(e){e&&!_()&&(this._itemNav.setCurrentItem(e),setTimeout(()=>{e.focus()},0))}_tokenKeyboardDelete(e,t){let o;const s=this._getVisibleTokens(),r=t?s.indexOf(t):s.indexOf(e.target),u=s.filter(P=>!P.selected);e.detail&&e.detail.backSpace?o=r===0?r+1:r-1:o=r===s.length-1?r-1:r+1;let c=s[o];if(u.length>1)for(;c&&c.selected;)c=e.detail.backSpace?s[--o]:s[++o];else c=u[0];this._handleCurrentItemAfterDeletion(c),this.fireEvent("token-delete",{ref:t||e.target})}itemDelete(e){const t=e.detail.item.tokenRef;this.fireEvent("token-delete",{ref:t})}_onkeydown(e){if(K(e)&&e.preventDefault(),W(e)||q(e))return e.preventDefault(),this._handleTokenSelection(e,!1);U(e)&&this._handleHomeShift(e),j(e)&&this._handleEndShift(e),this._handleItemNavigation(e,this._tokens)}_handleItemNavigation(e,t){const o=!!(e.metaKey||e.ctrlKey);if(Z(e)||T(e)||S(e)||F(e))return this._handleArrowCtrl(e,e.target,t,T(e)||S(e));if(J(e)||w(e)||X(e)||b(e)||Y(e)||y(e))return e.preventDefault(),this._handleArrowShift(e.target,t,w(e)||y(e)||b(e));if(G(e)||$(e)||Q(e)||C(e))return e.preventDefault(),this._handleHome(t,$(e)||C(e));if(o&&e.key.toLowerCase()==="a")return e.preventDefault(),this._toggleTokenSelection(t);if(ee(e)||E(e)||te(e)||I(e)){const s=this._calcNextTokenIndex(this._tokens.find(r=>r.focused),t,E(e)||I(e));this._scrollToToken(t[s])}}_handleHome(e,t){if(!e||!e.length)return-1;const o=t?e.length-1:0;e[o].focus(),this._itemNav.setCurrentItem(e[o])}_handleHomeShift(e){const t=this.tokens,o=t.indexOf(e.target);t.filter((s,r)=>r<=o).forEach(s=>{s.selected=!0}),t[0].focus(),this._itemNav.setCurrentItem(t[0])}_handleEndShift(e){const t=this.tokens,o=t.indexOf(e.target);t.filter((s,r)=>r>=o).forEach(s=>{s.selected=!0}),t[t.length-1].focus(),this._itemNav.setCurrentItem(t[t.length-1])}_calcNextTokenIndex(e,t,o){if(!t.length)return-1;const s=t.indexOf(e);let r=o?s+1:s-1;return r>=t.length&&(r=t.length-1),r<0&&(r=0),r}_handleArrowCtrl(e,t,o,s){const r=this._calcNextTokenIndex(t,o,s);e.preventDefault(),r!==-1&&(setTimeout(()=>o[r].focus(),0),this._scrollToToken(o[r]),this._itemNav.setCurrentItem(o[r]))}_handleArrowShift(e,t,o){const s=t.indexOf(e),r=o?s+1:s-1;r===-1||r===t.length||(e.selected=!0,t[r].selected=!0,setTimeout(()=>t[r].focus(),0),this._scrollToToken(t[r]),this._itemNav.setCurrentItem(t[r]))}_click(e){this._handleTokenSelection(e)}_onmousedown(e){e.target.hasAttribute("ui5-token")&&(e.target.toBeDeleted||(this._itemNav.setCurrentItem(e.target),this._scrollToToken(e.target)))}_toggleTokenSelection(e){if(!e||!e.length)return;const t=e.every(o=>o.selected);e.forEach(o=>{o.selected=!t})}_handleTokenSelection(e,t=!0){e.target.hasAttribute("ui5-token")&&(t?this._tokens:[e.target]).forEach(s=>{s!==e.target&&(s.selected=!1)})}_fillClipboard(e,t){const o=t.filter(r=>r.selected).map(r=>r.text).join(`\r
`),s=r=>{r.clipboardData?r.clipboardData.setData("text/plain",o):r.originalEvent.clipboardData.setData("text/plain",o),r.preventDefault()};document.addEventListener(e,s),document.execCommand(e),document.removeEventListener(e,s)}scrollToStart(){this._scrollEnablement.scrollContainer&&this._scrollEnablement.scrollTo(0,0)}scrollToEnd(){const e=this.expandedContentDom&&(this.effectiveDir!=="rtl"?this.expandedContentDom.scrollWidth:-this.expandedContentDom.scrollWidth);this._scrollEnablement.scrollContainer&&this._scrollEnablement.scrollTo(e,0,5,10)}_scrollToToken(e){if(!this.expandedContentDom)return;const t=e.getBoundingClientRect(),o=this.expandedContentDom.getBoundingClientRect();t.left<o.left?this._scrollEnablement.scrollTo(this.expandedContentDom.scrollLeft-(o.left-t.left+5),0):t.right>o.right&&this._scrollEnablement.scrollTo(this.expandedContentDom.scrollLeft+(t.right-o.right+5),0)}async closeMorePopover(){(await this.getPopover()).close()}get _nMoreText(){return p.i18nBundle.getText(ae,this._nMoreCount)}get showNMore(){return!this.expanded&&this.showMore&&this.overflownTokens.length}get contentDom(){return this.shadowRoot.querySelector(".ui5-tokenizer--content")}get expandedContentDom(){return this.shadowRoot.querySelector(".ui5-tokenizer-expanded--content")}get narrowContentDom(){return this.shadowRoot.querySelector(".ui5-tokenizer-nmore--content")}get tokenizerLabel(){return p.i18nBundle.getText(le)}get morePopoverTitle(){return p.i18nBundle.getText(de)}get overflownTokens(){return this.contentDom?(this._getTokens().forEach(e=>{e.overflows=!1}),this._getTokens().filter(e=>{const t=this.contentDom.getBoundingClientRect(),o=e.getBoundingClientRect(),s=parseInt(o.right),r=parseInt(t.right),u=parseInt(o.left),c=parseInt(t.left);return e.overflows=!this.expanded&&(u<c||s>r),e.overflows})):[]}get hasValueState(){return this.valueState===d.None||this.valueState===d.Success}get valueStateMessageText(){return this.getSlottedNodes("valueStateMessage").map(e=>e.cloneNode(!0))}get _valueStateMessageIcon(){const e={Error:"error",Warning:"alert",Success:"sys-enter-2",Information:"information"};return this.valueState!==d.None?e[this.valueState]:""}get _isPhone(){return _()}get _selectedTokens(){return this._getTokens().filter(e=>e.selected)}get classes(){return{wrapper:{"ui5-tokenizer-root":!0,"ui5-tokenizer-nmore--wrapper":this.showMore,"ui5-tokenizer-no-padding":!this._getTokens().length},content:{"ui5-tokenizer--content":!0,"ui5-tokenizer-expanded--content":!this.showNMore,"ui5-tokenizer-nmore--content":this.showNMore},popoverValueState:{"ui5-valuestatemessage-root":!0,"ui5-responsive-popover-header":this.showPopover,"ui5-valuestatemessage--success":this.valueState===d.Success,"ui5-valuestatemessage--error":this.valueState===d.Error,"ui5-valuestatemessage--warning":this.valueState===d.Warning,"ui5-valuestatemessage--information":this.valueState===d.Information}}}get styles(){return{popover:{"min-width":`${this.popoverMinWidth}px`},popoverValueStateMessage:{width:_()?"100%":`${this.popoverMinWidth}px`,"min-height":"2rem"},popoverHeader:{"min-height":"2rem"},popoverHeaderTitle:{"justify-content":"left"}}}_tokensCountText(){const e=this._getTokens().length;return e===0?p.i18nBundle.getText(pe):e===1?p.i18nBundle.getText(he):p.i18nBundle.getText(ce,e)}_focusLastToken(){if(this.tokens.length===0)return;const e=this.tokens[this.tokens.length-1];e.focus(),this._itemNav.setCurrentItem(e)}static get dependencies(){return[oe,ie,ne,se,re]}static async onDefine(){p.i18nBundle=await L("@ui5/webcomponents")}async getPopover(){return(await this.getStaticAreaItemDomRef()).querySelector("[ui5-responsive-popover]")}}p.define();export{p as T};
//# sourceMappingURL=Tokenizer-d0ae71b9.js.map
